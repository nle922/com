*NLZ: Program to create and clean the 1933 MS data, 10/9/10*Preliminariesclearcapture log closeset more off//cd "/Users/nicolaslehmannziebarth/Dropbox/Depression Census/Datasets/Mississippi"log using missippi_dataset_1933.txt, text replaceclearset mem 200minsheet using MS_1933.csvlabel define yesno 0 "No" 1 "Yes"replace isthisincorporated="1" if regexm(isthisincorporated,"Yes") | regexm(isthisincorporated,"Partnership") | regexm(isthisincorporated,"Incorporated") | regexm(isthisincorporated,"Cor") replace isthisincorporated="0" if regexm(isthisincorporated,"No")  destring isthisincorporated, replace forcelabel values isthisincorporated yesnoreplace state = "Mississippi" if regexm(state,"Columbia")replace subsidiary="1" if regexm(subsidiary,"Yes") replace subsidiary="0" if subsidiary~="1"replace subsidiary="" if isthisincorporated==.destring subsidiary, replace forcelabel values subsidiary yesnorename changedlocation change_locationreplace change_location = "1" if change_location == "Yes" | change_location == "420 Broadway"replace change_location = "0" if change_location == "No" | change_location == "None"destring change_location, replace forcelabel values change_location yesnolabel var change_location "Changed location?"rename changedname change_namereplace change_name = "1" if change_name == "Yes" | change_name == "Chinese Noodle Mfg Company" | change_name == "Oakland Noodle Factory"replace change_name = "0" if change_name == "No" | change_name == "None"destring change_name, replace forcelabel values change_name yesnolabel var change_name "Changed name?"rename changedownership change_ownershipreplace change_ownership = "1" if substr(change_ownership,1,4) == "Indi" | change_ownership == "V. Iuliano" | change_ownership == "YES" | change_ownership == "Yes"replace change_ownership = "1" if change_ownership == "Yes from Sosso to Sosso Jr" | change_ownership == "Yes from U.S. Macaroni Co." | change_ownership == "Yes, from Figler Saltzman and Co."replace change_ownership = "0" if change_ownership == "No" | change_ownership == "No Changes" | change_ownership == "no"destring change_ownership, replace forcelabel values change_ownership yesnoreplace began = "January 1, 1933" if began =="January, 1933"replace began = "January 1, 1934" if began =="January, 1934"replace end = "January 1, 1934" if end =="January, 1934"replace end = "May 31, 1933" if end=="May, 1933"replace end = "December 31, 1933" if end=="December, 1933"replace end = "December 31, 1934" if end=="December, 1934"replace began = "May 1, 1933" if began=="May, 1933"replace began = "Apri 1, 1933" if began=="April, 1933"label variable began "Date began"label variable end "Date end"replace numdaysplantinoperation = "6" if regexm(numdaysplantinoperation , "6 Days")replace numdaysplantinoperation = "94" if regexm(numdaysplantinoperation , "94 Days")replace numdaysplantinoperation = "117" if regexm(numdaysplantinoperation , "117")replace numdaysplantinoperation = "365" if regexm(numdaysplantinoperation , "Daily")replace numdaysplantinoperation = "0" if regexm(numdaysplantinoperation , "None")replace numdaysplantinoperation = "120" if regexm(numdaysplantinoperation , "About 120")replace numdaysplantinoperation = "160" if regexm(numdaysplantinoperation , "About 160")replace numdaysplantinoperation = "141" if regexm(numdaysplantinoperation , "About 141")replace numdaysplantinoperation = "300" if regexm(numdaysplantinoperation , "Practically")replace numdaysplantinoperation = "260" if regexm(numdaysplantinoperation , "All Week Days") | regexm(numdaysplantinoperation , "260")replace numdaysplantinoperation = "150" if regexm(numdaysplantinoperation , "Est. 150")destring numdaysplantinoperation, replace force ignore("Days")//have no idea what's going on in heredrop v21replace clerks="0" if clerks=="None"destring clerks, replace forcereplace officers="0" if officers=="None"destring officers, replace forcereplace managers="0" if managers=="None"destring managers, replace forcereplace proprietors="0" if proprietors=="None" | proprietors=="No"destring proprietors, replace forcereplace salariesforofficers="0" if salariesforofficers=="None" | officers==0destring salariesforofficers, replace forcereplace salariesformanagers="0" if salariesformanagers=="None" | managers==0destring salariesformanagers, replace forcereplace salariesforclerks="0" if salariesforclerks=="None" | salariesforclerks=="No" | clerks==0destring salariesforclerks, replace forceforeach i in "jan" "feb" "march" "april" "may" "june" "july" "august" "september" "october" "november" "december" "total"{tostring `i', replacereplace `i' = "0" if `i'=="None"destring `i', replace forcerename `i' wage_earners_`i'label var wage_earners_`i' "Number of wage earners"}rename v43 total_wages_salarieslabel variable total_wages_salaries "Total wages and salaries"//Need to check on this here. What's going on with these variables?replace costofallmaterials = v49 if costofallmaterials==.drop v49replace v45="0" if v45=="None"destring v45, replace forcerename v45 cost_materials_1label var cost_materials_1 "Cost of materials 1"replace v46="0" if v46=="None"destring v46, replace forcerename v46 cost_materials_2label var cost_materials_2 "Cost of materials 2"replace v47="0" if v47=="None"destring v47, replace forcerename v47 cost_materials_3label var cost_materials_3 "Cost of materials 3"rename v48 cost_materials_4label var cost_materials_4 "Cost of materials 4"replace costofcontractwork = "0" if costofcontractwork=="None"destring costofcontractwork, replace forcerename costofallmaterials total_cost_materialsdestring quantity, replace force ignore(" M#")rename quantity output_quantity_1rename unit output_unit_1rename value output_value_1rename specify output_specify_1label var output_quantity_1 "Quantity of output 1"label var output_unit_1 "Unit of output 1"label var output_value_1 "Value of output 1"label var output_specify_1 "Type of output 1"destring v55, replace force ignore(" M#Cases")rename v55 output_quantity_2rename v56 output_unit_2rename v57 output_value_2rename v58 output_specify_2label var output_quantity_2 "Quantity of output 2"label var output_unit_2 "Unit of output 2"label var output_value_2 "Value of output 2"label var output_specify_2 "Type of output 2"destring v59, replace force ignore(" M#Caselbs")destring v61, replace force ignore(" M#Caselbs")rename v59 output_quantity_3rename v60 output_unit_3rename v61 output_value_3rename v62 output_specify_3label var output_quantity_3 "Quantity of output 3"label var output_unit_3 "Unit of output 3"label var output_value_3 "Value of output 3"label var output_specify_3 "Type of output 3"drop morethan3productsreplace morethan3 = "1" if morethan3=="Yes"replace morethan3 = "0" if morethan3==""destring morethan3, replace forcelabel values morethan3 yesnorename morethan3 morethan3productslabel var morethan3products "More than 3 products?"rename totalvalue total_output_value//these variables appear to have been only filled in for the timber industry. Could be brought back.drop v65-morethanthreemachinesrename january manhours_januaryrename february manhours_februaryrename v91 manhours_marchrename v92 manhours_aprilrename v93 manhours_mayrename v94 manhours_junerename v95 manhours_julyrename v96 manhours_augustrename v97 manhours_septemberrename v98 manhours_octoberrename v99 manhours_novemberrename v100 manhours_decemberforeach i in "january" "february" "march" "april" "may" "june" "july" "august" "september" "october" "november" "december" {label var manhours_`i' "Manhours in `i'"}//strangely I thought there was some kind of capacity thing hererename horsedrawn horsedrawn_numberlabel var horsedrawn_number "Number of horsedrawn delivery vehicles"rename electric electric_numberlabel var electric_number "Number of electric delivery vehicles"rename gasoline gasoline_numberlabel var gasoline_number "Number of gasoline delivery vehicles"//never filled this indrop sameaddress generalschedulerename numberofhoursplantwasoperated hoursperweekreplace hoursperweek = lower(hoursperweek)destring hoursperweek, replace force ignore("abcdefghijklmnopqrstuvwxyz")replace output_unit_1 = "6 and 7 oz." if output_unit_1 == "7 oz."replace output_unit_1 = "6 and 7 oz." if output_unit_1 == "6 oz."replace output_unit_2 = "6 and 7 oz." if output_unit_2 == "7 oz."replace output_unit_2 = "6 and 7 oz." if output_unit_2 == "6 oz."replace output_unit_3 = "6 and 7 oz." if output_unit_3 == "7 oz."replace output_unit_3 = "6 and 7 oz." if output_unit_3 == "6 oz."replace output_unit_1 = "8, 9, and 10 oz." if output_unit_1 == "8, 9, oz."replace output_unit_1 = "8, 9, and 10 oz." if output_unit_1 == "9 oz."replace output_unit_2 = "8, 9, and 10 oz." if output_unit_2 == "8, 9, oz."replace output_unit_2 = "8, 9, and 10 oz." if output_unit_2 == "9 oz."replace output_unit_3 = "8, 9, and 10 oz." if output_unit_3 == "8, 9, oz."replace output_unit_3 = "8, 9, and 10 oz." if output_unit_3 == "9 oz."replace output_unit_1 = "Dozens" if output_unit_1 == "Doz"replace output_unit_2 = "Dozens" if output_unit_2 == "Doz"replace output_unit_3 = "Dozens" if output_unit_3 == "Doz"replace output_unit_1 = "Barrels" if output_unit_1 == "Barrels(200 lbs)"replace output_unit_2 = "Barrels" if output_unit_2 == "Barrels(200 lbs)"replace output_unit_3 = "Barrels" if output_unit_3 == "Barrels(200 lbs)"replace output_unit_1 = "Tons" if output_unit_1 == "Tons 2000 Lbs."replace output_unit_2 = "Tons" if output_unit_2 == "Tons 2000 Lbs."replace output_unit_3 = "Tons" if output_unit_3 == "Tons 2000 Lbs."replace output_unit_1 = "Tons" if output_unit_1 == "Tons 2000 Lbr"replace output_unit_2 = "Tons" if output_unit_2 == "Tons 2000 Lbr"replace output_unit_3 = "Tons" if output_unit_3 == "Tons 2000 Lbr"replace output_unit_1 = "Tons" if output_unit_1 == "Tons of 2000 Lbs"replace output_unit_2 = "Tons" if output_unit_2 == "Tons of 2000 Lbs"replace output_unit_3 = "Tons" if output_unit_3 == "Tons of 2000 Lbs"replace output_unit_1 = "Tons" if output_unit_1 == "Tons of 2000 Lbs."replace output_unit_2 = "Tons" if output_unit_2 == "Tons of 2000 Lbs."replace output_unit_3 = "Tons" if output_unit_3 == "Tons of 2000 Lbs."replace output_unit_1 = "M Feet B.M." if output_unit_1 == "M Feet, B.M."replace output_unit_2 = "M Feet B.M." if output_unit_2 == "M Feet, B.M."replace output_unit_3 = "M Feet B.M." if output_unit_3 == "M Feet, B.M."replace output_unit_1 = "Pounds" if output_unit_1 == "Lbs"replace output_unit_2 = "Pounds" if output_unit_2 == "Lbs"replace output_unit_3 = "Pounds" if output_unit_3 == "Lbs"replace output_unit_1 = "Pounds" if output_unit_1 == "Lb."replace output_unit_2 = "Pounds" if output_unit_2 == "Lb."replace output_unit_3 = "Pounds" if output_unit_3 == "Lb."replace output_unit_1 = "Thousands" if output_unit_1 == "Thousand"replace output_unit_2 = "Thousands" if output_unit_2 == "Thousand"replace output_unit_3 = "Thousands" if output_unit_3 == "Thousand"replace output_specify_1 = "Can Ice (Raw Water)" if output_specify_1 == "Ice"replace output_specify_2 = "Can Ice (Raw Water)" if output_specify_2 == "Ice"replace output_specify_3 = "Can Ice (Raw Water)" if output_specify_3 == "Ice"replace output_specify_1 = "Can Ice (Raw Water)" if output_specify_1 == "Ice Making"replace output_specify_2 = "Can Ice (Raw Water)" if output_specify_2 == "Ice Making"replace output_specify_3 = "Can Ice (Raw Water)" if output_specify_3 == "Ice Making"replace output_specify_1 = "Can Ice (Raw Water)" if output_specify_1 == "Artificial Ice"replace output_specify_2 = "Can Ice (Raw Water)" if output_specify_2 == "Artificial Ice"replace output_specify_3 = "Can Ice (Raw Water)" if output_specify_3 == "Artificial Ice"replace output_specify_1 = "Receipts from Cold Storage" if output_specify_1 == "Receipt from Cold Storage"replace output_specify_2 = "Receipts from Cold Storage" if output_specify_2 == "Receipt from Cold Storage"replace output_specify_3 = "Receipts from Cold Storage" if output_specify_3 == "Receipt from Cold Storage"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Cotton Seed Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Cotton Seed Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Cotton Seed Oil"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Oil-Cottonseed"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Oil-Cottonseed"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Oil-Cottonseed"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Crude Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Crude Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Crude Oil"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "C.S. Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "C.S. Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "C.S. Oil"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Oil"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Crude Cotton Seed Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Crude Cotton Seed Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Crude Cotton Seed Oil"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Crude Cottonseed Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Crude Cottonseed Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Crude Cottonseed Oil"replace output_specify_1 = "Cottonseed Oil" if output_specify_1 == "Crude C/S Oil"replace output_specify_2 = "Cottonseed Oil" if output_specify_2 == "Crude C/S Oil"replace output_specify_3 = "Cottonseed Oil" if output_specify_3 == "Crude C/S Oil"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Meal"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Meal"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Meal"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Meal & Cake"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Meal & Cake"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Meal & Cake"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Cake"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Cake"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Cake"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Cake and Meal"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Cake and Meal"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Cake and Meal"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Cotton Seed Cake and Meal"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Cotton Seed Cake and Meal"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Cotton Seed Cake and Meal"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Meal-Cotton Seed"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Meal-Cotton Seed"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Meal-Cotton Seed"replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "Cottonseed Meal"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "Cottonseed Meal"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "Cottonseed Meal"foreach i in "Cotton Seed Meal" "C.S. Meal" "Cotton Seed Meal & Cake" "C/S Cake & Meal" "Cottonseed Cake- Meal" {replace output_specify_1 = "Cottonseed Cake & Meal" if output_specify_1 == "`i'"replace output_specify_2 = "Cottonseed Cake & Meal" if output_specify_2 == "`i'"replace output_specify_3 = "Cottonseed Cake & Meal" if output_specify_3 == "`i'"}foreach i in "Sacked Hulls" "Losee Hulls" "Loose Hulls"{replace output_specify_1 = "Hulls" if output_specify_1 == "`i'"replace output_specify_2 = "Hulls" if output_specify_2 == "`i'"replace output_specify_3 = "Hulls" if output_specify_3 == "`i'"}foreach i in "Cottonseed Linters" "Lint" "Lint Sales"{replace output_specify_1 = "Linters" if output_specify_1 == "`i'"replace output_specify_2 = "Linters" if output_specify_2 == "`i'"replace output_specify_3 = "Linters" if output_specify_3 == "`i'"}rename wagespaid total_wagesdrop manhours_january-manhours_december change_name change_location change_ownership cost_materials_1-cost_materials_4 imagenumberrename horsedrawn_number delivery_horsedrawn_numberrename gasoline_number delivery_gasoline_numberrename electric_number delivery_electric_numberrename costofcontractwork total_cost_contract_workgen total_cost = total_wages+total_cost_materials//firmids are started in 1933.sort nameofplant  county  citytownorvillage  postofficeaddress  streetandnumbergen firmid = _ngen censusyear=1933rename salariesforclerks salaries_clerksrename salariesforofficers salaries_officersrename salariesformanagers salaries_managerstostring *, replace force//should be able to clean up industry 114 as well//still probably some more cleaning necessary to make good names consistent across yearssave MS_1933, replacelog close